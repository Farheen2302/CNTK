# the following uses one more layer, so totally two layers of LSTMs, to model directional predictions
# --------- training -------------
# s30jointconditionalbilstmn300n300n300

#local
\\speechstore5\transient\kaishengy\bin\binluapr20\cn.exe configFile=C:\dev\cntk5\ExampleSetups\G2P\setups\global.lstm.config+C:\dev\cntk5\ExampleSetups\G2P\setups\bilstm.config DeviceNumber=Auto LSTM=[SGD=[numMBsToShowResult=1000]] ExpDir=d:\exp\lts\result\reps30bilstm LSTM=[SGD=[gradientcheck=true]]

C:\dev\cntk5\x64\Release\CNTK.exe configFile=C:\dev\cntk5\ExampleSetups\G2P\setups\global.lstm.config+C:\dev\cntk5\ExampleSetups\G2P\setups\bilstm.config DeviceNumber=Auto LSTM=[SGD=[numMBsToShowResult=1000]] ExpDir=d:\temp\reps30bilstm 

C:\dev\cntk5\x64\Release\CNTK.exe configFile=C:\dev\cntk5\ExampleSetups\G2P\setups\global.lstm.config+C:\dev\cntk5\ExampleSetups\G2P\setups\bilstm.config deviceNumber=-1 command=LSTMTest Iter=39 MdlDir=d:\temp\reps30bilstm bw=0 LSTMTest=[beamWidth=$bw$] LSTMTest=[modelPath=$MdlDir$\cntkdebug.dnn.$Iter$] ExpDir=$MdlDir$\test_bw$bw$_iter$Iter$ command=LSTMTest


# reps30bilstm
\\speechstore5\transient\kaishengy\bin\binluapr20\cn.exe configFile=\\speechstore5\userdata\kaishengy\exp\lts\setups\global.lstm.config+\\speechstore5\userdata\kaishengy\exp\lts\setups\bilstm.config DeviceNumber=Auto LSTM=[SGD=[numMBsToShowResult=1000]] ExpDir=\\speechstore5\transient\kaishengy\exp\lts\result\reps30bilstm

# local with NDL
\\speechstore5\transient\kaishengy\bin\binluapr20\cn.exe configFile=C:\dev\cntk5\ExampleSetups\G2P\setups\global.lstm.config+C:\dev\cntk5\ExampleSetups\G2P\setups\bilstm.ndl.config DeviceNumber=Auto LSTM=[SGD=[numMBsToShowResult=1000]] ExpDir=d:\exp\lts\result\reps30bilstmndl LSTM=[SGD=[gradientcheck=true]]


# ---------- test ----------------
for %i in (0,1) do q sub -J testbm%ibilstm -x \\speechstore5\userdata\kaishengy\exp\lts\exes\jobs.s30.bat 35 \\speechstore5\transient\kaishengy\exp\lts\result\reps30bilstm %i

\\speechstore5\transient\kaishengy\bin\binluapr20\cn.exe configFile=\\speechstore5\userdata\kaishengy\exp\lts\setups\global.lstm.config+\\speechstore5\userdata\kaishengy\exp\lts\setups\bilstm.config DeviceNumber=-1 command=LSTMTest Iter=35 MdlDir=\\speechstore5\transient\kaishengy\exp\lts\result\reps30bilstm bw=0 LSTMTest=[beamWidth=$bw$] LSTMTest=[modelPath=$MdlDir$\cntkdebug.dnn.$Iter$] ExpDir=$MdlDir$\test_bw$bw$_iter$Iter$

#************************************************
# test on the previously trained model
\\speechstore5\transient\kaishengy\bin\binluapr20\cn.exe configFile=\\speechstore5\userdata\kaishengy\exp\lts\setups\global.lstm.config+\\speechstore5\userdata\kaishengy\exp\lts\setups\bilstm.config DeviceNumber=-1 command=LSTMTest Iter=34 MdlDir=\\speechstore5\transient\kaishengy\exp\lts\result\s30jointconditionalbilstmn300n300n300 bw=0 LSTMTest=[beamWidth=$bw$] LSTMTest=[modelPath=$MdlDir$\cntkdebug.dnn.$Iter$] ExpDir=$MdlDir$\test_bw$bw$_iter$Iter$

for %i in (0,1) do q sub -J oldmodeltestbm%ibilstm -x \\speechstore5\userdata\kaishengy\exp\lts\exes\jobs.s30.bat 35 \\speechstore5\transient\kaishengy\exp\lts\result\s30rndjointconditionalbilstmn300n300n300 %i

 